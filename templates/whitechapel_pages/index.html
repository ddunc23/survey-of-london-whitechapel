{% extends 'map/base.html' %}

{% block content %}

<div class="jumbotron whitechapel_front_page">
	
	<style>
		/*.carousel_image {
			width: 100%;
			position: absolute;
			top: 0;
		}*/
		.carousel {
			height: 500px;
			width: 100%;
			position: absolute;
			top: 0;
			overflow: hidden;
			display: block;
			z-index: 1;
		}
	</style>
	<div class="container" style="position: relative; z-index: 2;">
		<h1 class="text-center">{{ title }}</h1>
		<h2 class="text-center">{{ page.title }} | Draft</h2>
		<br />
		<div class="text-center">
			<a href="{% url 'map_home' %}" class="btn btn-lg explore">Explore the Map</a>
		</div>
	</div>
	<div class="carousel">
		<div style="background-image: url('/media/{{ page.banner_image_1 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
		<div style="background-image: url('/media/{{ page.banner_image_2 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
		<div style="background-image: url('/media/{{ page.banner_image_3 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
	</div>
</div>
{% load thumbnail %}
<div class="container">
	<div class="row"><!-- Front Page Text -->
		<div class="col-xs-12 col-md-8">
			<div class="front-page-about">
				<h1 class="front-page-heading">{{ page.title }}</h1>
				{{ page.body|safe }}
			</div>
		</div>
		<div class="col-xs-12 col-md-4"><!-- Latest contributions -->
			<h1 class="front-page-heading">Latest Contributions</h1>
			{% for item in latest|slice:":3" %}
			{% if item.created != None %}
				{% if item.file %}
				<div class="media">
					<div class="media-left">
						<a href="{% url 'detail' item.feature.id %}#images"><img src="{% thumbnail item.file 64x64 crop='0,0' %}" class="img-rounded"></a>
					</div>
					<div class="media-body">
						<h3 class="media-heading"><a href="{% url 'detail' item.feature.id %}#{{ item.document_type }}">{{ item.title }}</a></h3>
						<h4 class="small"><a href="{% url 'detail' item.feature.id %}">{{ item.feature }}</a> | <a href="{% url 'all_content_by_author' item.author.id %}">{% if item.author.userprofile.display_name %}{{ item.author.userprofile.display_name }}{% else %}{{ item.author }}{% endif %}</a> | {{ item.created }}</h4>
						<p class="results-preview">{{ item.description|truncatewords_html:20|striptags }}</p>
					</div>
				</div>
				{% else %}
				<div>
					<h3><a href="{% url 'detail' item.feature.id %}#{{ item.document_type }}">{{ item.title }}</a></h3>
					<h4 class="small"><a href="{% url 'detail' item.feature.id %}">{{ item.feature }}</a> | <a href="{% url 'all_content_by_author' item.author.id %}">{% if item.author.userprofile.display_name %}{{ item.author.userprofile.display_name }}{% else %}{{ item.author }}{% endif %}</a> | {{ item.created }}</h4>
					{% if item.body_processed %}
					<p class="results-preview">{{ item.body_processed|truncatewords_html:20|striptags }}</p>
					{% elif item.description %}
					<p class="results-preview">{{ item.description|truncatewords_html:20|striptags }}</p>
					{% endif %}
				</div>
				{% endif %}		
			{% endif %}

			{% endfor %}
	</div></div>

	
	

	<div class="row">
		<div class="col-xs-12 col-md-4"><!-- Featured Contributions -->
			<h1 class="front-page-heading">Building of the Week</h1>
			<div class="row">
				{% for document in page.documents.all %}
				{% if document.published == True %}
				<div class="{% cycle 'col-xs-12' 'col-xs-12 col-md-6' 'col-xs-12 col-md-6' %}">
					<a href="{% url 'detail' document.feature.id %}#images"><img src="{% thumbnail document.feature.thumbnail 400x225 crop='0,0' %}" class="img-rounded" style="width: 100%;"></a>
					<h3><a href="{% url 'detail' document.feature.id %}#{{ document.document_type }}?{{ document.title|slugify }}">{{ document.title }}</a><br /><span class="small"><a href="{% url 'all_content_by_author' document.author.id %}">{{ document.author.userprofile.display_name }}</a> | {{ document.feature }}</span></h3>
					<p>{{ document.body|safe|truncatewords_html:40|striptags }}</p>
				</div>
				{% endif %}
				{% endfor %}
			</div>
		</div><!-- / Featured Contribution -->
		<div class="col-xs-12 col-md-8"><! Help Movie -->
			<h1 class="front-page-heading">Browsing the Map</h1>
			<div class="embed-responsive embed-responsive-16by9">
				<iframe width="560" height="315" src="https://www.youtube.com/embed/EoUhVp5NIQE" frameborder="0" allowfullscreen></iframe>
			</div>
			<p class="lead">If you're not sure about how to get started, we've made a short video to give you a quick overview.</p>
		</div>

	</div><!-- / Help Movie -->

	{% if categories %}
	<div class="row"><!-- Themes -->
		<div class="col-xs-12">
			<h1 class="front-page-heading">Explore Whitechapel</h1>
			<p class="lead">Not sure where to begin? Click on a theme to start uncovering Whitechapel's past.</p>
			<br />
		</div>
	</div>
	
	<div class="row themed-content">
		{% for category in categories %}	
		<div class="col-xs-12 col-md-3">
			<div>
				<a href="{% url 'map.views.category' category.id %}"><img src="{% thumbnail category.thumbnail 360x204 %}"></a>
				<p><a href="{% url 'map.views.category' category.id %}">{{ category.name }}</a></p>
			</div>
		</div>
		{% if forloop.counter|divisibleby:4 %}
		</div>
		<div class="row themed-content">
		{% endif %}
		{% endfor %}
	</div><!-- / Themes -->
	{% endif %}
</div><!-- / Container -->

{% endblock %}

