{% extends 'map/base.html' %}

{% block content %}

<div class="jumbotron whitechapel_front_page">
	
	<style>
		/*.carousel_image {
			width: 100%;
			position: absolute;
			top: 0;
		}*/
		.carousel {
			height: 500px;
			width: 100%;
			position: absolute;
			top: 0;
			overflow: hidden;
			display: block;
			z-index: 1;
		}
	</style>
	<div class="container" style="position: relative; z-index: 2;">
		<h1 class="text-center">{{ title }}</h1>
		<h2 class="text-center">{{ page.title }} | Draft</h2>
		<br />
		<div class="text-center">
			<a href="{% url 'map_home' %}" class="btn btn-primary btn-lg">Explore the Map</a>
		</div>
	</div>
	<div class="carousel">
		<div style="background-image: url('/media/{{ page.banner_image_1 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
		<div style="background-image: url('/media/{{ page.banner_image_2 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
		<div style="background-image: url('/media/{{ page.banner_image_3 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
	</div>
</div>
{% load thumbnail %}
<div class="container">
	<div class="row"><!-- Front Page Text -->
		<div class="col-xs-12 col-md-8">
			<div class="front-page-about">
				<h1 class="front-page-heading">{{ page.title }}</h1>
				{{ page.body|safe }}
			</div>
		</div>
		{% if page.blog_post %}
		<div class="col-xs-12 col-md-4"><!-- News -->
			<h1 class="front-page-heading">Next Event</h1>
			<h3><a href="{% url 'single_post' year=page.blog_post.date_published|date:'Y' post=page.blog_post.slug %}">{{ page.blog_post.title }}</a></h3>
			<p class="results-preview">{{ page.blog_post.body|truncatewords_html:25|safe|striptags }}</p>
		</div>
		{% endif %}
		<div class="col-xs-12 col-md-4"><!-- News -->
			<h1 class="front-page-heading">News</h1>
			{% for post in posts %}
			<h3><a href="{% url 'single_post' year=post.date_published|date:'Y' post=post.slug %}">{{ post.title }}</a></h3>
			<p class="results-preview">{{ post.body|truncatewords_html:25|safe|striptags }}</p>
			{% endfor %}
		</div><!-- / News -->
	</div>

	
	{% if page.images %}
	<div class="row"><!-- Featured Images -->
		<div class="col-xs-12"><h1 class="front-page-heading">Featured Images</h1></div>
	</div>
	<div class="row">
		{% for image in page.images.all %}
		<div class="col-xs-12 col-md-4">
		<a href="{% url 'detail' image.feature.id %}#images"><img src="{% thumbnail image.file 400x225 crop='0,0' %}" class="img-rounded" style="width: 100%;"></a>
		<h3><span class="text-muted"><a href="{% url 'detail' image.feature.id %}#images">{{ image.title }}</a></span><br />
		<span class="small"><a href="{% url 'all_content_by_author' image.author.id %}">{% if image.author.userprofile.display_name %}{{ image.author.userprofile.display_name }}{% else %}{{ image.author }}{% endif %}</a> | <a href="{% url 'detail' image.feature.id %}">{{ image.feature }}</a></h3>
		</div>
 		{% endfor %}
	</div>	
	{% endif %}

	<div class="row"><!-- Featured Content and Latest Images -->
		<div class="col-xs-12 col-md-8"><!-- Featured Contributions -->
			<h1 class="front-page-heading">Featured Contributions</h1>
			<div class="row">
				{% for document in page.documents.all %}
				{% if document.published == True %}
				<div class="{% cycle 'col-xs-12' 'col-xs-12 col-md-6' 'col-xs-12 col-md-6' %}">
					<h3><a href="{% url 'detail' document.feature.id %}#{{ document.document_type }}?{{ document.title|slugify }}">{{ document.title }}</a><br /><span class="small"><a href="{% url 'all_content_by_author' document.author.id %}">{{ document.author.userprofile.display_name }}</a> | {{ document.feature }} | Submitted {{ document.last_edited }}</span></h3>
					<p>{{ document.body|safe|truncatewords_html:40|striptags }}</p>
				</div>
				{% endif %}
				{% endfor %}
			</div>
		</div><!-- / Featured Contributions -->
		
		<div class="col-xs-12 col-md-4"><!-- Latest contributions -->
			<h1 class="front-page-heading">Latest Contributions</h1>
			{% for item in latest|slice:":4" %}
			{% if item.created != None %}
				{% if item.file %}
				<div class="media">
					<div class="media-left">
						<a href="{% url 'detail' item.feature.id %}#images"><img src="{% thumbnail item.file 64x64 crop='0,0' %}" class="img-rounded"></a>
					</div>
					<div class="media-body">
						<h3 class="media-heading"><a href="{% url 'detail' item.feature.id %}#{{ item.document_type }}">{{ item.title }}</a></h3>
						<h4 class="small"><a href="{% url 'detail' item.feature.id %}">{{ item.feature }}</a> | <a href="{% url 'all_content_by_author' item.author.id %}">{% if item.author.userprofile.display_name %}{{ item.author.userprofile.display_name }}{% else %}{{ item.author }}{% endif %}</a> | {{ item.created }}</h4>
						<p class="results-preview">{{ item.description|truncatewords_html:20|striptags }}</p>
					</div>
				</div>
				{% else %}
				<div>
					<h3><a href="{% url 'detail' item.feature.id %}#{{ item.document_type }}">{{ item.title }}</a></h3>
					<h4 class="small"><a href="{% url 'detail' item.feature.id %}">{{ item.feature }}</a> | <a href="{% url 'all_content_by_author' item.author.id %}">{% if item.author.userprofile.display_name %}{{ item.author.userprofile.display_name }}{% else %}{{ item.author }}{% endif %}</a> | {{ item.created }}</h4>
					{% if item.body_processed %}
					<p class="results-preview">{{ item.body_processed|truncatewords_html:20|striptags }}</p>
					{% elif item.description %}
					<p class="results-preview">{{ item.description|truncatewords_html:20|striptags }}</p>
					{% endif %}
				</div>
				{% endif %}		
			{% endif %}

			{% endfor %}
		</div> <!-- / Latest contributions -->

	</div><!-- / Featured Content and Latest Images -->

	<div class="row front-page-media"><!-- Featured Media -->
		<div class="col-xs-12">
			<h1 class="front-page-heading">Audio and Video</h1>
		</div>
		{% load embed_video_tags %}
		<div class="row">
			{% for embed in page.media.all %}
			<div class="col-xs-12 col-md-6">
				<div class="col-xs-12 col-md-4">
					<h3>{{ embed.title }}</h3>
					<div>{{ embed.description|safe }}</div>
				</div>
				<div class="col-xs-12 col-md-8">
					<div class="embed-responsive embed-responsive-4by3">
						{% video embed.url 'large' %}
					</div>
				</div>
			</div>
			{% endfor %}
		</div>
	</div>

	{% if categories %}
	<div class="row"><!-- Themes / Routes / Tours -->
		<div class="col-xs-12">
			<h1 class="front-page-heading">Explore Whitechapel</h1>
			<br />
		</div>
	</div>
	
	<div class="row themed-content">
		{% for category in categories %}
		{% if category.feature_set.all %}
		<div class="col-xs-12 col-md-3">
			<div>
				<a href="{% url 'map.views.category' category.id %}"><img src="{% thumbnail category.thumbnail 360x204 %}"></a>
				<p><a href="{% url 'map.views.category' category.id %}">{{ category.name }}</a></p>
			</div>
		</div>
		{% endif %}
		{% endfor %}
	</div><!-- / Themed Content -->
	{% endif %}
</div><!-- / Container -->

{% endblock %}

