{% extends 'map/base.html' %}

{% block json-ld %}
<!-- Schema Metadata -->
<script type="application/ld+json">	
{
	"@context": "http://schema.org",
	"@type": "WebSite",
	"url": "https://surveyoflondon.org/",
	"author": {
		"@context": "http://schema.org",
		"@type": "EducationalOrganization",
		"name": "Survey of London",
		"address": {
			"@context": "http://schema.org",
			"@type": "PostalAddress",
			"addressCountry": "United Kingdom",
			"addressLocality": "London",
			"postalCode": "EC1N 2ST",
			"streetAddress": "Survey of London, c/o Historic England, 1 Waterhouse Square, 138-142 Holborn"
		}
	},
	"about": {
		"@context": "http://schema.org",
		"@type": "Place",
		"name": "Whitechapel"
	},
	"description": "The Survey of London’s Whitechapel project, where you can share and explore the many histories of Whitechapel’s buildings and places."
}
</script>
{% endblock %}

{% block content %}

<div class="jumbotron whitechapel_front_page">
	
	<style>
		.carousel {
			height: 500px;
			width: 100%;
			position: absolute;
			top: 0;
			overflow: hidden;
			display: block;
			z-index: 1;
		}
	</style>
	<div class="container" style="position: relative; z-index: 2;">
		<h1 class="text-center">{{ title }}</h1>
		<h2 class="text-center">{{ page.title }}</h2>
		<br />
		<div class="text-center">
			<a href="{% url 'map_home' %}" class="btn btn-lg explore">Explore the Map</a>
		</div>
	</div>
	<div class="carousel">
		{% if page.banner_image_1 %}
		<div style="background-image: url('/media/{{ page.banner_image_1 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
		{% endif %}
		{% if page.banner_image_2 %}
		<div style="background-image: url('/media/{{ page.banner_image_2 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
		{% endif %}
		{% if page.banner_image_3 %}
		<div style="background-image: url('/media/{{ page.banner_image_3 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
		{% endif %}
		{% if page.banner_image_4 %}
		<div style="background-image: url('/media/{{ page.banner_image_4 }}'); background-size: cover; display: block; width: 100%; height: 600px; background-position: center center;'"></div>
		{% endif %}
	</div>
</div>
{% load thumbnail %}
<div class="container">
	<div class="row"><!-- Front Page Text -->
		<div class="col-xs-12 col-md-8">
			<div class="front-page-about">
				<h1 class="front-page-heading">{{ page.title }}</h1>
				{{ page.body|safe }}
			</div>
		</div>
		<div class="col-xs-12 col-md-4"><!-- Latest contributions and Newsletter -->
			<h1 class="front-page-heading">Latest Contributions</h1>
			{% for item in latest|slice:":4" %}
			{% if item.created != None %}
				{% if item.file %}
				<div class="media">
					<div class="media-left">
						<a href="{% url 'detail' item.feature.id %}#images"><img src="{% thumbnail item.file 64x64 crop='0,0' %}" class="img-rounded"></a>
					</div>
					<div class="media-body">
						<h3 class="media-heading"><a href="{% url 'detail' item.feature.id %}#images">{{ item.title }}</a></h3>
						<h4 class="small"><a href="{% url 'detail' item.feature.id %}">{{ item.feature }}</a> | <a href="{% url 'all_content_by_author' item.author.id %}">{% if item.author.userprofile.display_name %}{{ item.author.userprofile.display_name }}{% else %}{{ item.author }}{% endif %}</a> | {{ item.created }}</h4>
						<p class="results-preview">{{ item.description|truncatewords_html:20|striptags }}</p>
					</div>
				</div>
				{% else %}
				<div>
					<h3><a href="{% url 'detail' item.feature.id %}#{{ item.document_type }}?{{ item.title|slugify }}">{{ item.title }}</a></h3>
					<h4 class="small"><a href="{% url 'detail' item.feature.id %}">{{ item.feature }}</a> | <a href="{% url 'all_content_by_author' item.author.id %}">{% if item.author.userprofile.display_name %}{{ item.author.userprofile.display_name }}{% else %}{{ item.author }}{% endif %}</a> | {{ item.created }}</h4>
					{% if item.body_processed %}
					<p class="results-preview">{{ item.body_processed|truncatewords_html:20|striptags }}</p>
					{% elif item.description %}
					<p class="results-preview">{{ item.description|truncatewords_html:20|striptags }}</p>
					{% endif %}
				</div>
				{% endif %}		
			{% endif %}
			{% endfor %}
			<h1 class="front-page-heading">Subscribe to our Newsletter</h1>
			<form action="https://tinyletter.com/surveyoflondon" method="post" target="popupwindow" onsubmit="window.open('https://tinyletter.com/surveyoflondon', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
				<div class="input-group">
					<input type="text" name="email" id="tlemail" class="form-control" placeholder="Email" /><br />
					<span class="input-group-btn">
						<input type="submit" value="Subscribe" class="btn btn-default" />
					</span>
				</div>
				<p><a href="https://tinyletter.com" target="_blank">Powered by TinyLetter</a></p>
				<input type="hidden" value="1" name="embed"/>
			</form>
			<div class="quick-contribution">
				<form role="form" action="" method="post">
					<h1 class="front-page-heading">Tell us about Whitechapel</h1>
					<p>If you'd rather not sign up for an account, you can tell us your memories of Whitechapel using the form below</p>
					{% load crispy_forms_tags %}
					{% csrf_token %}
					{{ form|crispy }}
					<button type="submit" class="btn btn-default">Submit</button>
				</form>
			</div>
	</div></div>

	
	

	<div class="row">
		{% if page.building_of_the_week %}
		<div class="col-xs-12 col-md-4"><!-- Building of the Month -->
			<h1 class="front-page-heading">Building of the Month</h1>
			<div class="row">
				<div class="col-xs-12">
					<a href="{% url 'detail' page.building_of_the_week.id %}#images"><img src="{% thumbnail page.building_of_the_week.thumbnail 400x225 crop='0,0' %}" class="img-rounded" style="width: 100%;"></a>
					<h3><a href="{% url 'detail' page.building_of_the_week.id %}">{{ page.building_of_the_week }}</a></h3>
					<p class="lead">We don't know much about this building yet. Can you tell us something about its history?</p>
					<p class="lead"><a href="{% url 'ugc_choice' page.building_of_the_week.id %}">Contribute it here</a></p>
				</div>
			</div>
		</div><!-- / Building of the Week -->
		{% endif %}
		<div class="col-xs-12 col-md-8"><!-- Help Movie -->
			<h1 class="front-page-heading">Browsing the Map</h1>
			<div class="embed-responsive embed-responsive-16by9">
				<iframe width="560" height="315" src="https://www.youtube.com/embed/q3A1ov8xoLc" frameborder="0" allowfullscreen></iframe>
			</div>
			<p class="lead">If you're not sure about how to get started, we've made a short video to give you a quick overview.</p>
		</div>

	</div><!-- / Help Movie -->

	{% if categories %}
	<div class="row"><!-- Themes -->
		<div class="col-xs-12">
			<h1 class="front-page-heading">Explore Whitechapel</h1>
			<p class="lead">Not sure where to begin? Click on a theme to start uncovering Whitechapel's past. Sites are being tagged if they connect with certain overlapping aspects of Whitechapel's history, according to the thematic categories identified here.</p>
			<br />
		</div>
	</div>
	
	<div class="row themed-content">
		{% for category in categories %}	
		<div class="col-xs-12 col-md-3">
			<div>
				<a href="{% url 'map.views.category' category.id %}"><img src="{% thumbnail category.thumbnail 360x204 %}"></a>
				<p><a href="{% url 'map.views.category' category.id %}">{{ category.name }}</a></p>
			</div>
		</div>
		{% if forloop.counter|divisibleby:4 %}
		</div>
		<div class="row themed-content">
		{% endif %}
		{% endfor %}
	</div><!-- / Themes -->
	{% endif %}
</div><!-- / Container -->

{% endblock %}

